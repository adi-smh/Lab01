---
title: "Lab 01 - UK Attractions"
author: "Adi Hirasaki"
date: "`r Sys.Date()`"
output: html_document
---


### Load packages and data

```{r load-packages, message=FALSE}
# Do not edit this code chunk!
library(tidyverse) 
```

```{r load-data, message=FALSE}
# Do not edit this code chunk!
visitors <- read_csv("data/UK-visitor-numbers.csv")
```


# Wrangling Data

## Question 1

_How many tourist attractions are there in the data set?_
There are 348 tourist attractions in the data set.
```{r Q1}
visitors %>% count()
```

### Exercise a.

_Create a frequency table of the number of tourist attractions in the data set by `region`._

```{r Ex_a}
visitors %>% count(region)
```

### Exercise b.

_Create a frequency table by `admission` and `setting`._

```{r Ex_b}
visitors %>% count(admission, setting)
```


## Question 2

_What are the variable data types?_

```{r Q2_part1}
class(visitors$n_2022)
```

```{r Q2_part2}
visitors %>% summarise_all(class)
```
attraction=chr, n_2021 = numeric, n_2022 = numeric, admission = chr, setting = chr, region = chr


## Question 3

_Which attraction had the most number of visitors in 2022?_

```{r Q3}
visitors %>% arrange(desc(n_2022))
```
The Crown Estate, Windsor Great Park, had the most visitors in 2022.

### Exercise c.

_What are the top 10 most visited attractions in 2021?_
```{r Ex_c}
visitors %>% 
  arrange(desc(n_2021)) %>%
  head(n = 10)
```
The 10 most visited attractions in 2022 are, in order: The Crown Estate, Windsor Great Park, Royal Botanic Gardens Kew, Natural History Museum (South Kensington), RHS Garden Wisley, The British Museum, Tate Modern, Somerset House, Science Museum, Jeskyns Community Woodland, and V&A South Kensington.

## Question 4

_What is the admission charge for the `"National Museum of Scotland"`?_
```{r Q4}
visitors %>% filter(attraction == "National Museum of Scotland")
```
The National Museum of Scotland has an admission charge of $0, free.

### Exercise d.

_Which attraction had exactly 565,772 visitors in 2022?_

```{r Ex_d}
visitors %>% filter(n_2022 == 565772)
```
Knowsley Safari and Knowsley Hall had exactly 565,772 visitors in 2022.

### Exercise e.

_How many attraction had more than 1 million visitors in 2022?_

```{r Ex_e}
visitors %>% 
  filter(n_2022 > 1000000) %>%
  count()
```
22 attractions had more than 1 million visitors in 2022.

## Question 5

_How many `"O"`utside attractions are there in the `"Yorkshire and the Humber"` region that gives `"Members"` free admission, which had more than 100,000 visitors in 2022?_

```{r Q5}
visitors %>%
  filter(
    setting == "O",
    region == "Yorkshire and the Humber",
    admission == "Members",
    n_2022 >= 100000
    ) %>%
  count()
```
There are three outside attractions in the Yorkshire and the Humber region that only give admission to Members and had 100,000 or more visitors in 2022.

### Exercise f.

_How many attractions had between 50,000 and 100,000 visitors in 2022?_

```{r Ex_f}
visitors %>% 
  filter(
    50000 < n_2022,
    100000 > n_2022) %>%
  count()
```
50 attractions had between 50,000 and 100,000 visitors in 2022.

### Exercise g.

_How many regions have more than 50 tourist attraction in the data set? (Hint: You will need to tabulate, or count, the data before filtering.)_

```{r Ex_g}
visitors %>% 
  count(region) %>%
  filter(n > 50)
```
Scotland is the only region with more than 50 tourist attractions in the data set.

# Summarising Data

## Question 6

_What are the mean and median visitor numbers in 2022 across all attractions?_

```{r Q6}
visitors %>% 
  summarise(
    mean_2022 = mean(n_2022),
    med_2022 = median(n_2022)
  )
```
mean_2022 = 351942, med_2022 = 184639.5

### Exercise h.

_Perform the same calculation for the 2021 admissions data._

```{r Ex_h}
visitors %>% 
  summarize(
    mean_2021 = mean(n_2021),
    med_2021 = median(n_2021)
  )
```
All values in the output are `NA`!

### Exercise i.

_What does `NA` stand for and why are you getting this as your answer to the previous question._

**Write your answer here**
'Na' stands for not applicable. I am getting this as my answer to the previous question because the variable n_2021 includes NA values. In order to get an answer, I should include na.rm = TRUE in my code.

### Exercise j.

_Look at the help pages for the `mean()` and `median()` commands to see what the input argument `na.rm` does. Edit your code from exercise h so that it computes the summary statistics where data is available._

The input argument `na.rm` ignores all NA values so that calculations can be made using only the existing values.
```{r Ex_j}
visitors %>% 
  summarize(
    mean_2021 = mean(n_2021, na.rm = TRUE),
    med_2021 = median(n_2021, na.rm = TRUE)
  )
```

## Question 7

_Which setting (inside, outside or mixed) has the largest mean visitor numbers in 2022?_

```{r Q7}
visitors %>% 
  group_by(setting) %>%
  summarise(
    mean_2022 = mean(n_2022),
    med_2022 = median(n_2022)
  )
```
Inside setting attractions had the highest mean visitor numbers in 2022.

### Exercise k.

_Observe in question 6 that the mean statistics across all settings are much larger than the corresponding median statistics. Discuss in your group what this suggests about the data._

**Write your answer here**
This suggests that there are outliers with high values influencing the mean value that have less impact on the median value.

## Question 8

_What is the interquartile range (the width of the middle 50% of data set between the lower and upper quartiles) the for each of the four nations of the UK?_

```{r Q8}
visitors_with_nations <- visitors %>%
  mutate(
    nation = case_when(
      region == "Northern Ireland" ~ "Northern Ireland",
      region == "Scotland" ~ "Scotland",
      region == "Wales" ~ "Wales",
      TRUE ~ "England"
    )
  )

visitors_with_nations %>% 
  group_by(nation) %>%
  summarise(
    IQR_2022 = IQR(n_2022)
  )
```
The IQR of England is 350362.2.
The IQR of Northern Ireland is 311046.
The IQR of Scotland is 127986.
The IQR of Wales is 103368.5.

### Exercise l.

_How many tourist attractions are there in each of the 4 nations? From this, discuss in your group how reliable you think the inter-quartile estimates are._

```{r Ex_l}
visitors_with_nations <- visitors %>%
  mutate(
    nation = case_when(
      region == "Northern Ireland" ~ "Northern Ireland",
      region == "Scotland" ~ "Scotland",
      region == "Wales" ~ "Wales",
      TRUE ~ "England"
    )
  )

visitors_with_nations %>% 
  group_by(nation) %>%
  count()
```
There are 240 tourist attractions in England, 9 in Northern Ireland, 97 in Scotland, and 2 in Wales. I think the IQR is more accurate in England and Scotland than in Northern Ireland and Wales, as the sample size is larger and less susceptible to outliers.

# Challenging Exercises

### Exercise m.

_Within each of the 4 nations, what is the proportion of tourist attractions that have free admission for all visitors?_

```{r Ex_m}
visitors_with_nations <- visitors %>%
  mutate(
    nation = case_when(
      region == "Northern Ireland" ~ "Northern Ireland",
      region == "Scotland" ~ "Scotland",
      region == "Wales" ~ "Wales",
      TRUE ~ "England"
    )
  )
visitors_with_nations |>
  group_by(admission, nation) |>
  count() |>
  ungroup() |>
  mutate(
    prop = n / sum(n)
  )

```
26.72% of attractions in England, 0.29% of attractions in Northern Ireland, 9.77% of attractions in Scotland, and 0% of attractions in Wales offer free admission.

### Exercise n.

_Calculate the percentage change in visitor admissions from 2021 to 2022. Of the tourist attractions in Scotland, sort into increasing numerical order the types of admission charges based on the mean percentage change in visitor numbers._

```{r Ex_n}
visitors |>
  mutate(
    perc_change = (n_2022 - n_2021) / n_2021 * 100
    ) |>
  filter(region == "Scotland") |>
  group_by(admission) |>
  summarise(
    mean_perc_change = mean(perc_change, na.rm = TRUE)
  ) |>
  arrange(mean_perc_change)

```